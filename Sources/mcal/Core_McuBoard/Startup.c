/***********************************************************************
*   Copyright (C) Huizhou Desay SV Automotive Co., Ltd.				   *
*				  All Rights Reserved.          			   *
*   Department : CT AD     							  *
*   AUTHOR	   : 							*
************************************************************************
* Object        :
* Module        :
* Instance      :
* Description   :
*-----------------------------------------------------------------------
* Version:
* Date:
* Author:
***********************************************************************/
/*-History--------------------------------------------------------------
* Version       Date    Name    Changes and comments
*-----------------------------------------------------------------------
* 0.1	 Jan 20,2016   init version.
*-----------------------------------------------------------------------
* 0.2	 Dec 20,2016   ShangQiuju Remove unused include files.
*----------------------------------------------------------------------
* 0.3        Jan 24,2017    ZhangJie     Fix Coverity warning.
*=====================================================*/

/*
*********************************************************************************************************
*                                             INCLUDE FILES
*********************************************************************************************************
*/
#include "Startup.h"
#include "Wdg_Adapt_if.h"
#include "SystemManager_if.h"
#include "TraceServ_if.h"
/*
*********************************************************************************************************
*                                            LOCAL DEFINES
*********************************************************************************************************
*/


/*
*********************************************************************************************************
*                                           LOCAL CONSTANTS
*********************************************************************************************************
*/


/*
*********************************************************************************************************
*                                          LOCAL DATA TYPES
*********************************************************************************************************
*/


/*
*********************************************************************************************************
*                                            LOCAL TABLES
*********************************************************************************************************
*/


/*
*********************************************************************************************************
*                                       LOCAL GLOBAL VARIABLES
*********************************************************************************************************
*/


/*
*********************************************************************************************************
*                                      LOCAL FUNCTION PROTOTYPES
*********************************************************************************************************
*/

extern void MCU_HardwareInit(void);
extern void MCU_MainInit(void);
extern void Capture_Adapt_CycleTask(void);
static MYBOOL smbCycle10msState = FALSE;

/*
*********************************************************************************************************
*                                             REGISTERS
*********************************************************************************************************
*/


/*
*********************************************************************************************************
*                                            REGISTER BITS
*********************************************************************************************************
*/



/*
*********************************************************************************************************
*                                     LOCAL CONFIGURATION ERRORS
*********************************************************************************************************
*/

/***********************************************************************
* Name        	: main
* Description	: startup code
* Description	: None
* Returns     	: int
***********************************************************************/

/*---Global-----------------------------------------------------------*/


/***********************************************************************
* Name        	: main
* Description	: startup code
* Description	: None
* Returns     	: int
***********************************************************************/
int main( void )
{
   	/*init driver*/
    MCU_HardwareInit();
	/* enable watchdog,add by hhx 20200427 */
   	Wdg_Adapt_Init();
	Wdg_Adapt_Enable();
	/* enable watchdog,add by hhx 20200427 */
	
    MCU_MainInit();

    SystemMgr_Init();//initial app module,add by hhx 20190920

    while(TRUE)
    {
    	if(TRUE == smbCycle10msState)
    	{
    		smbCycle10msState = FALSE;
    		SystemMgr_CycleTask10ms();
    	}
		Capture_Adapt_CycleTask();
		Wdg_Adapt_Clear();//feed watchdog
    }
    return 0;
}

void Active10msTask(void)
{
	smbCycle10msState = TRUE;
}

